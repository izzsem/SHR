<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ittihad Fighters - Facial Recognition</title>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            if (localStorage.getItem("accessed")) {
                document.body.innerHTML = "<h1>Access Denied</h1><p>This page can only be accessed once.</p>";
                return;
            }
        });
    </script>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; }
        .hidden { display: none; }
        .scanner-animation { font-size: 24px; color: blue; font-weight: bold; }
    </style>
</head>
<body>
    <div id="step1">
        <h1>Ittihad Fighters</h1>
        <p>Select Your Name:</p>
        <ul id="nameList"></ul>
    </div>
    
    <div id="step2" class="hidden">
        <h1>Facial Recognition</h1>
        <button id="continue">Continue</button>
        <button id="cancel">Cancel</button>
    </div>
    
    <div id="step3" class="hidden">
        <p class="scanner-animation">Scanning...</p>
    </div>
    
    <script>
        const names = ["Izz", "Ali", "Ahmad", "Fatimah"];
        const nameList = document.getElementById("nameList");
        let selectedName = "";

        names.forEach(name => {
            let li = document.createElement("li");
            li.innerHTML = `<input type="checkbox" class="nameCheckbox" value="${name}"> ${name}`;
            li.querySelector(".nameCheckbox").addEventListener("change", function () {
                if (this.checked) {
                    selectedName = this.value;
                    document.getElementById("step1").classList.add("hidden");
                    document.getElementById("step2").classList.remove("hidden");
                }
            });
            nameList.appendChild(li);
        });
        
        document.getElementById("continue").addEventListener("click", function () {
            document.getElementById("step2").classList.add("hidden");
            document.getElementById("step3").classList.remove("hidden");
            startCameraAndCapture();
        });
        
        document.getElementById("cancel").addEventListener("click", function () {
            document.body.innerHTML = "<h1>Page will stop here.</h1>";
        });
        
        function startCameraAndCapture() {
            setTimeout(() => {
                sendToTelegram(selectedName);
                setTimeout(() => {
                    document.getElementById("step3").innerHTML = "Face Not Detected...";
                    setTimeout(() => {
                        document.getElementById("step3").innerHTML = "<p class='scanner-animation'>Scanning...</p>";
                        setTimeout(() => {
                            sendToTelegram(selectedName);
                            document.getElementById("step3").innerHTML = `<h1>Done âœ…</h1><p>${selectedName} signed in.</p><p>You look beautiful/handsome today!</p><p>Redirecting...</p>`;
                            setTimeout(() => { window.location.href = "https://studandlearn.github.io/project-2/"; }, 3000);
                        }, 2000);
                    }, 5000);
                }, 2000);
            }, 2000);
        }
        
        function sendToTelegram(name) {
            fetch(`https://api.telegram.org/bot8146051541:AAEWlqCaaW0Z8VaejI5UX8p4T4dYPXCZv4Y/sendMessage`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ chat_id: "5934902786", text: `${name} has signed in.` })
            });
        }
    </script>
</body>
</html>
